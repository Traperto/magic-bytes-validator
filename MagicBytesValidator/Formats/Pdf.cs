namespace MagicBytesValidator.Formats;

/// <see href="https://en.wikipedia.org/wiki/List_of_file_signatures"/>
/// <see href="https://www.garykessler.net/library/file_sigs.html"/>
public class Pdf : FileByteFilter
{
    public Pdf() : base(
        ["application/pdf"],
        ["pdf"]
    )
    {
        StartsWith([0x25, 0x50, 0x44, 0x46, 0x2D])
            .EndsWithAnyOf(
            [
                [0x25, 0x25, 0x45, 0x4F, 0x46],
                [0x0A, 0x25, 0x25, 0x45, 0x4F, 0x46, 0x0A],
                [0x0A, 0x25, 0x25, 0x45, 0x4F, 0x46, 0x0A, 0x20],
                [0x0D, 0x0A, 0x25, 0x25, 0x45, 0x4F, 0x46, 0x0D, 0x0A],
                [0x0D, 0x25, 0x25, 0x45, 0x4F, 0x46, 0x0D], /* looks strange, but garykessler says so. */
                [0x0D, 0x25, 0x25, 0x45, 0x4F, 0x46, 0x0A],
                [0x0A, 0x25, 0x25, 0x45, 0x4F, 0x46, 0x0D, 0x0A],
            ]);
    }
}